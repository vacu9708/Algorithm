# [순위 검색](https://school.programmers.co.kr/learn/courses/30/lessons/72412)
## parsing+combination+hashmap+sort+binary search
~~~python
from collections import defaultdict
def combination(depth,r,start,parsed_info,info_map):
    if depth==r:
        info_map[' '.join(parsed_info[:-1])].append(int(parsed_info[-1]))
        return
    for i in range(start,len(parsed_info)-1):
        ori=parsed_info[i]
        parsed_info[i]='-'
        combination(depth+1,r,i+1,parsed_info,info_map)
        parsed_info[i]=ori

def solution(info, query):
    answer = [0 for i in range(len(query))]
    # Put all possible combinations of condition as key with their scores as value into hashmap
    info_map=defaultdict(list)
    for a in info:
        parsed_info=a.split()
        for r in range(5):
            combination(0,r,0,parsed_info,info_map)
    # Sort scores in descending order for binary search
    for key in info_map:
        info_map[key].sort(reverse=True)

    for i in range(len(query)):
        # Get scores from the hashmap with the condition of query
        parsed_query=query[i].replace(' and','').split()
        scores=info_map[' '.join(parsed_query[:-1])]
        # Find how many scores match the score range of the query with binary search
        target=int(parsed_query[-1])
        left,right=0,len(scores)-1
        while left<=right:
            mid=(left+right)//2
            if scores[mid]<target:
                right=mid-1
            else:
                left=mid+1
        answer[i]+=left
    return answer
~~~
